# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

### Notific.py
1. **SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏** - ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
   - –í—Å–µ SQL-–∑–∞–ø—Ä–æ—Å—ã —Å –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–µ–π —Å—Ç—Ä–æ–∫ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `cursor.execute(query, (param,))` –≤–º–µ—Å—Ç–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏

2. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
   - –ó–∞–º–µ–Ω–µ–Ω—ã –≥–æ–ª—ã–µ `except Exception:` –Ω–∞ `except Exception as e:` —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

### html_template.py
1. **XSS-–∑–∞—â–∏—Ç–∞** - ‚úÖ –ß–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
   - –î–æ–±–∞–≤–ª–µ–Ω–æ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `template_html_new_issue_msk()`
   - –£–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –≤ `template_html_new_issue_vln()`

## üî¥ –û—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ
1. **–ü–∞—Ä–æ–ª—å –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ** (Notific.py:121, 247)
   ```python
   user_passwd = "$GjvjoM%"
   ```
   **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º

2. **XSS-—É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö html_template.py**
   - `template_html()` - —Å—Ç—Ä–æ–∫–∏ 434-570
   - `template_html_Assigned()` - —Å—Ç—Ä–æ–∫–∏ 729-887
   - `template_html_AddNotes()` - —Å—Ç—Ä–æ–∫–∏ 891-956
   - –ò –¥—Ä—É–≥–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —à–∞–±–ª–æ–Ω–æ–≤

   **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –î–æ–±–∞–≤–∏—Ç—å `escape()` –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö:
   ```python
   def template_html(issueID, body, strParam, oldParam, newParam, dateCreated, author, status, priority, assigned):
       safe_issueID = escape(str(issueID))
       safe_body = escape(str(body))
       safe_strParam = escape(str(strParam))
       # ... –∏ —Ç.–¥.
   ```

### –°—Ä–µ–¥–Ω–∏–µ
1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ email** –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
   - –§—É–Ω–∫—Ü–∏—è `validate_email()` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ

2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
   - Email-–∞–¥—Ä–µ—Å–∞ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ

## üü° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### Notific.py

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –¥–ª—è –ë–î**
   ```python
   with mysql.connector.connect(...) as cnx:
       with cnx.cursor(buffered=True) as cursor:
           # –∫–æ–¥ —Ä–∞–±–æ—Ç—ã —Å –ë–î
   ```

2. **–í—ã–Ω–µ—Å—Ç–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞**
   ```python
   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SMTP
   SMTP_SERVER = "mail.tez-tour.com"
   SMTP_PORT = 25
   SMTP_USERNAME = "help@tez-tour.com"

   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ë–î (–∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è)
   DB_USER = os.getenv('DB_USER', 'easyredmine')
   DB_PASSWORD = os.getenv('DB_PASSWORD')
   DB_HOST = os.getenv('DB_HOST', 'helpdesk.teztour.com')
   DB_NAME = os.getenv('DB_NAME', 'redmine')
   ```

3. **–£–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞**
   - –°–æ–∑–¥–∞—Ç—å –æ–±—â—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –∏–∑ —Ç–∞–±–ª–∏—Ü
   - –°–æ–∑–¥–∞—Ç—å –æ–±—â—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è SQL-–∑–∞–ø—Ä–æ—Å–æ–≤**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JOIN –≤–º–µ—Å—Ç–æ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–≤ –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
   - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–µ –ø–æ–ª—è

### html_template.py

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä** (Jinja2)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –£–ø—Ä–æ—â–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏

2. **–í—ã–Ω–µ—Å—Ç–∏ CSS –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏**
   - –°–æ–∑–¥–∞—Ç—å –æ–±—â–∏–π CSS-—Ñ–∞–π–ª –¥–ª—è –≤—Å–µ—Ö —à–∞–±–ª–æ–Ω–æ–≤
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å—ã –≤–º–µ—Å—Ç–æ inline-—Å—Ç–∏–ª–µ–π

3. **–°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω**
   - –í—ã–Ω–µ—Å—Ç–∏ –æ–±—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É (header, footer)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤

## üìã –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π (–∫—Ä–∏—Ç–∏—á–Ω–æ)
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏ –≤ Notific.py
2. ‚ö†Ô∏è –í—ã–Ω–µ—Å—Ç–∏ –ø–∞—Ä–æ–ª—å –∏–∑ –∫–æ–¥–∞ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å XSS-–∑–∞—â–∏—Ç—É –≤–æ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ html_template.py

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–π (–≤–∞–∂–Ω–æ)
4. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
5. –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ —Å retry-–ª–æ–≥–∏–∫–æ–π
6. –î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–π (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ)
7. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä Jinja2
8. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –û–û–ü
9. –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥
10. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## üîí –ü—Ä–∏–º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∫–æ–¥–∞

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
```python
import os
from dotenv import load_dotenv

load_dotenv()

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
DB_PASSWORD = os.getenv('DB_PASSWORD')
SMTP_PASSWORD = os.getenv('SMTP_PASSWORD')

if not DB_PASSWORD or not SMTP_PASSWORD:
    raise ValueError("–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã")
```

### –®–∞–±–ª–æ–Ω —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç XSS
```python
from html import escape

def safe_template(user_data):
    # –í—Å–µ–≥–¥–∞ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
    safe_data = {
        key: escape(str(value)) if value is not None else ''
        for key, value in user_data.items()
    }
    return template.format(**safe_data)
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã
```python
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (—É—è–∑–≤–∏–º–æ –∫ SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏)
query = f"DELETE FROM users WHERE id = {user_id}"
cursor.execute(query)

# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û (–±–µ–∑–æ–ø–∞—Å–Ω–æ)
query = "DELETE FROM users WHERE id = %s"
cursor.execute(query, (user_id,))
```

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –ù–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª–∏ –∏ —Ç–æ–∫–µ–Ω—ã
   - –ú–∞—Å–∫–∏—Ä–æ–≤–∞—Ç—å email-–∞–¥—Ä–µ—Å–∞ –≤ –ª–æ–≥–∞—Ö
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

2. **Email –≤–∞–ª–∏–¥–∞—Ü–∏—è**
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ñ–æ—Ä–º–∞—Ç –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å whitelist –¥–æ–º–µ–Ω–æ–≤ –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ
   - –ó–∞—â–∏—Ç–∞ –æ—Ç email injection

3. **Rate limiting**
   - –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ email –≤ –º–∏–Ω—É—Ç—É
   - –ó–∞—â–∏—Ç–∞ –æ—Ç —Ñ–ª—É–¥–∞

4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
   - –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –∞–Ω–æ–º–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
   - –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
